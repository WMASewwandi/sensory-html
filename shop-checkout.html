<!DOCTYPE html>
<html lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <base href="/">

    <title>Checkout - Sensory - Kids Toys Store</title>

    <!--== Favicon ==-->
    <link rel="shortcut icon" href="/assets/img/favicon.ico" type="image/x-icon" />

    <!--== Google Fonts ==-->
    <link href="https://fonts.googleapis.com/css?family=Fredoka+One:400" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <!--== Bootstrap CSS ==-->
    <link href="/assets/css/bootstrap.min.css" rel="stylesheet"/>
    <!--== Font-awesome Icons CSS ==-->
    <link href="/assets/css/font-awesome.min.css" rel="stylesheet"/>
    <!--== Pe Icon 7 Min Icons CSS ==-->
    <link href="/assets/css/pe-icon-7-stroke.min.css" rel="stylesheet"/>
    <!--== Ionicons CSS ==-->
    <link href="/assets/css/ionicons.css" rel="stylesheet"/>
    <!--== Animate CSS ==-->
    <link href="/assets/css/animate.css" rel="stylesheet"/>
    <!--== Aos CSS ==-->
    <link href="/assets/css/aos.css" rel="stylesheet"/>
    <!--== FancyBox CSS ==-->
    <link href="/assets/css/jquery.fancybox.min.css" rel="stylesheet"/>
    <!--== Slicknav CSS ==-->
    <link href="/assets/css/slicknav.css" rel="stylesheet"/>
    <!--== Swiper CSS ==-->
    <link href="/assets/css/swiper.min.css" rel="stylesheet"/>
    <!--== Slick CSS ==-->
    <link href="/assets/css/slick.css" rel="stylesheet"/>
    <!--== Rangeslider CSS ==-->
    <link href="/assets/css/rangeslider.css" rel="stylesheet"/>
    <!--== Main Style CSS ==-->
    <link href="/assets/css/style.css" rel="stylesheet" />

</head>

<body>

<!--wrapper start-->
<div class="wrapper page-shop-wrapper">

  <!--== Start Preloader Content ==-->
  <div class="preloader-wrap">
    <div class="preloader">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
  <!--== End Preloader Content ==-->

  <!--== Start Header Wrapper ==-->
  <header class="header-wrapper">
    <div class="header-top">
      <div class="container">
        <div class="row">
          <div class="col-xs-12 col-sm-5 col-md-4 col-lg-6">
            <div class="header-info-left">
            </div>
          </div>
          <div class="col-xs-12 col-sm-7 col-md-8 col-lg-6 sm-pl-0 xs-pl-15 header-top-right">
            <div class="header-info">
              <a href="tel://+94761487787"><i class="fa fa-phone"></i> +94761487787</a>
              <a href="mailto:sensorysl12@gmail.com"><i class="fa fa-envelope"></i> sensorysl12@gmail.com</a>
              <a href="login-register.html"><i class="fa fa-user"></i> Account</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="header-middle">
      <div class="container">
        <div class="row row-gutter-0 align-items-center">
          <div class="col-12">
            <div class="header-align">
              <div class="header-align-left">
                <div class="header-logo-area">
                  <a href="index.html">
                    <img class="logo-main" src="/assets/img/logo.png" alt="Logo" />
                    <img class="logo-light" src="/assets/img/logo.png" alt="Logo" />
                  </a>
                </div>
              </div>
              <div class="header-align-center">
                <div class="header-search-box">
                  <form action="#" method="post">
                    <div class="form-input-item">
                      <label for="search" class="sr-only">Search Everything</label>
                      <input type="text" id="search" placeholder="Search Everything">
                      <button type="submit" class="btn-src">
                        <i class="pe-7s-search"></i>
                      </button>
                    </div>
                  </form>
                </div>
              </div>
              <div class="header-align-right">
                <div class="header-action-area">
                  <div class="header-action-wishlist">
                    <button class="btn-wishlist" onclick="window.location.href='shop-wishlist.html'">
                      <i class="pe-7s-like"></i>
                    </button>
                  </div>
                  <div class="header-action-cart">
                    <button class="btn-cart cart-icon" onclick="window.location.href='shop-cart.html'">
                      <span class="cart-count">0</span>
                      <i class="pe-7s-shopbag"></i>
                    </button>
                  </div>
                  <button class="btn-menu d-md-none">
                    <i class="ion-navicon"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="header-area header-default sticky-header">
      <div class="container">
        <div class="row row-gutter-0 align-items-center">
          <div class="col-4 col-sm-6 col-lg-2">
            <div class="header-logo-area">
              <a href="index.html">
                <img class="logo-main" src="/assets/img/logo.png" alt="Logo" />
                <img class="logo-light" src="/assets/img/logo.png" alt="Logo" />
              </a>
            </div>
          </div>
          <div class="col-lg-8 sticky-md-none">
            <div class="header-navigation-area d-none d-md-block">
              <ul class="main-menu nav position-relative">
                <li class="active"><a class="ml--2" href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <!-- <li class="has-submenu"><a href="index.html">Pages</a>
                  <ul class="submenu-nav">
                    <li><a href="shop-cart.html">Cart page</a></li>
                    <li><a href="shop-checkout.html">Checkout</a></li>
                    <li><a href="my-account.html">My Account</a></li>
                    <li><a href="shop-wishlist.html">Wishlist</a></li>
                    <li><a href="shop-compare.html">Compare</a></li>
                    <li><a href="login-register.html">Login / Register</a></li>
                    <li><a href="coming-soon.html">Coming soon</a></li>
                    <li><a href="page-not-found.html">404</a></li>
                  </ul>
                </li> -->
                <li><a href="shop-left-sidebar.html">Shop</a></li>
                <li><a href="contact.html">Contact</a></li>
              </ul>
            </div>
          </div>
          <div class="col-8 col-sm-6 col-lg-2">
            <div class="header-action-area">
              <div class="header-action-search">
                <button class="btn-search btn-search-menu">
                  <i class="pe-7s-search"></i>
                </button>
              </div>
              <div class="header-action-login">
                <button class="btn-login" onclick="window.location.href='login-register.html'">
                  <i class="pe-7s-users"></i>
                </button>
              </div>
              <div class="header-action-wishlist">
                <button class="btn-wishlist" onclick="window.location.href='shop-wishlist.html'">
                  <i class="pe-7s-like"></i>
                </button>
              </div>
              <div class="header-action-cart">
                <button class="btn-cart cart-icon" onclick="window.location.href='shop-cart.html'">
                  <span class="cart-count">0</span>
                  <i class="pe-7s-shopbag"></i>
                </button>
              </div>
              <button class="btn-menu d-lg-none">
                <i class="ion-navicon"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>
  <!--== End Header Wrapper ==-->
  
  <main class="main-content">
    <!--== Start Page Title Area ==-->
    <section class="page-title-area">
      <div class="container">
        <div class="row align-items-center">
          <div class="col-lg-12 m-auto">
            <div class="page-title-content text-center">
              <h2 class="title">Checkout</h2>
              <!-- <div class="bread-crumbs"><a href="index.html"> Home </a><span class="breadcrumb-sep"> // </span><span class="active"> Checkout</span></div> -->
            </div>
          </div>
        </div>
      </div>
    </section>
    <!--== End Page Title Area ==-->

    <!--== Start Checkout Area Wrapper ==-->
    <section class="product-area shop-checkout-area">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 m-auto">
            <div class="section-title text-center">
              <h2 class="title">Checkout</h2>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-lg-12">
          </div>
        </div>
        <div class="row">
          <div class="col-lg-7">
            <div class="billing-info-wrap">
              <h3>Billing Details</h3>
              <div class="row">
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>First name <abbr class="required" title="required">*</abbr></label>
                    <input type="text">
                  </div>
                </div>
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>Last name <abbr class="required" title="required">*</abbr></label>
                    <input type="text">
                  </div>
                </div>
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>Street Address <abbr class="required" title="required">*</abbr></label>
                    <input class="billing-address" placeholder="House number and street name" type="text">
                    <input placeholder="Apartment, suite, unit, etc. (optional)" type="text">
                  </div>
                </div>
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>Town / City <abbr class="required" title="required">*</abbr></label>
                    <input type="text">
                  </div>
                </div>
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>District <abbr class="required" title="required">*</abbr></label>
                    <input type="text">
                  </div>
                </div>
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>Postcode / ZIP (optional) <abbr class="required" title="required">*</abbr></label>
                    <input type="text">
                  </div>
                </div>
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>Phone <abbr class="required" title="required">*</abbr></label>
                    <input type="text">
                  </div>
                </div>
                <div class="col-12">
                  <div class="billing-info mb-20">
                    <label>Email Address <abbr class="required" title="required">*</abbr></label>
                    <input type="text">
                  </div>
                </div>
              </div>
              <div class="additional-info-wrap">
                <label>Order notes (optional)</label>
                <textarea placeholder="Notes about your order, e.g. special notes for delivery. " name="message"></textarea>
              </div>
            </div>
          </div>
          <div class="col-lg-5">
            <div class="your-order-area">
              <h3>Your order</h3>
              <div class="your-order-wrap">
                <div class="your-order-info-wrap">
                  <div class="your-order-title">
                    <h4>Product <span>Subtotal</span></h4>
                  </div>
                  <div class="your-order-product">
                    <ul>
                      <!-- Order items will be loaded dynamically here -->
                    </ul>
                  </div>
                  <div class="your-order-subtotal">
                    <h3>Subtotal <span id="checkout-subtotal">LKR 0.00</span></h3>
                  </div>
                  <div class="your-order-shipping">
                    <h3>Shipping <span id="checkout-shipping">LKR 450.00</span></h3>
                    <p class="shipping-note" style="font-size: 12px; color: #666; margin-top: 8px; margin-bottom: 0;">Free shipping for orders over LKR 40,000</p>
                  </div>
                  <div class="your-order-total">
                    <h3>Total <span id="checkout-total">LKR 0.00</span></h3>
                  </div>
                </div>
                <div class="payment-method">
                  <div class="pay-top sin-payment">
                    <input id="payment_method_1" class="input-radio" type="radio" value="cheque" checked="checked" name="payment_method">
                    <label for="payment_method_1"> Direct Bank Transfer </label>
                    <div class="payment-box payment_method_bacs">
                      <p>Make your payment directly into our bank account. Please use your Order ID as the payment reference. Your order will not be shipped until the funds have cleared in our account.</p>
                    </div>
                  </div>
                </div>
                <div class="payment-condition">
                  <p>Your personal data will be used to process your order, support your experience throughout this website, and for other purposes described in our <a href="privacy-policy.html">privacy policy</a>.</p>
                </div>
              </div>
              <div class="place-order">
                <a href="#/">Place Order</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!--== End Checkout Area Wrapper ==-->
  </main>

  <!--== Start Footer Area Wrapper ==-->
  <footer class="footer-area default-style" >
    <div class="footer-main">
      <div class="container">
        <div class="row">
          <div class="col-12 col-lg-4">
            <div class="widget-item item-style3">
              <div class="about-widget">
                <a class="footer-logo" href="index.html">
                  <img src="/assets/img/logo-light.png" alt="Logo">
                </a>
                <p>
                  Sensory a brand of ANKH Trading Pvt Ltd is a curated destination for premium sensory books, toddler sensory, and early learning products, created to support holistic childhood development. We bring together safe, reliable, and thoughtfully designed sensory essentials in one placeâ€”making it easier for parents, educators, and retailers to access quality products that encourage learning through play, exploration, and imagination.
0 
                </p>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-2">
            <div class="widget-item item-style1">
              <h4 class="widget-title">Quick Links</h4>
              <h4 class="widget-title widget-collapsed-title collapsed" data-bs-toggle="collapse" data-bs-target="#dividerId-1">Quick Links</h4>
              <div id="dividerId-1" class="collapse widget-collapse-body">
                <nav class="widget-menu-wrap">
                  <ul class="nav-menu nav item-hover-style">
                    <li><a href="index.html">- Home</a></li>
                    <li><a href="about.html">- About</a></li>
                    <li><a href="shop-left-sidebar.html">- Shop</a></li>
                    <li><a href="contact.html">- Contact</a></li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-3">
            <div class="widget-item item-style2">
              <h4 class="widget-title">Company</h4>
              <h4 class="widget-title widget-collapsed-title collapsed" data-bs-toggle="collapse" data-bs-target="#dividerId-3">Company</h4>
              <div id="dividerId-3" class="collapse widget-collapse-body">
                <nav class="widget-menu-wrap item-hover-style">
                  <ul class="nav-menu nav">
                    <li><a href="terms-and-conditions.html">- Terms & Conditions</a></li>
                    <li><a href="privacy-policy.html">- Privacy Policy</a></li>
                  </ul>
                </nav>
              </div>
            </div>
          </div>
          <div class="col-12 col-lg-3">
            <div class="widget-item">
              <h4 class="widget-title">Store Information.</h4>
              <h4 class="widget-title widget-collapsed-title collapsed" data-bs-toggle="collapse" data-bs-target="#dividerId-4">Store Information.</h4>
              <div id="dividerId-4" class="collapse widget-collapse-body">
                <p class="widget-address">296/A/1 , Level 2 <br>New Kandy Road, <br>Kothalawala, <br>Kaduwela,
                    <br>Sri Lanka</p>
                  <ul class="widget-contact-info">
                    <li>Phone: <a href="tel://+94761487787">+94761487787</a></li>
                    <li>Email: <a href="mailto:sensorysl12@gmail.com">sensorysl12@gmail.com</a></li>
                  </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-bottom">
      <div class="container">
        <div class="footer-bottom-content">
          <div class="row text-center">
            <div class="col-sm-12">
              <div class="widget-copyright">
                <p><i class="fa fa-copyright"></i> 2025 <span>Sensory. </span> All Rights Reserved</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="footer-shape bg-img" data-bg-img="/assets/img/photos/footer1.png"></div>
  </footer>
  <!--== End Footer Area Wrapper ==-->
  
  <!--== Scroll Top Button ==-->
  <div class="scroll-to-top"><span class="fa fa-angle-double-up"></span></div>

  <!--== Start Product Quick View ==-->
  <aside class="product-quick-view-modal">
    <div class="product-quick-view-inner">
      <div class="product-quick-view-content">
        <button type="button" class="btn-close">
          <span class="pe-7s-close"><i class="lastudioicon-e-remove"></i></span>
        </button>
        <div class="row row-gutter-0">
          <div class="col-lg-6 col-md-6 col-12">
            <div class="thumb">
              <img src="/assets/img/shop/quick-view1.jpg" alt="Image">
            </div>
          </div>
          <div class="col-lg-6 col-md-6 col-12">
            <div class="single-product-info">
              <h4 class="title">Your Products Name Here.</h4>
              <div class="prices">
                <span class="price">LKR 0.00</span>
              </div>
              <div class="product-rating">
                <div class="rating">
                  <span class="fa fa-star"></span>
                  <span class="fa fa-star"></span>
                  <span class="fa fa-star"></span>
                  <span class="fa fa-star"></span>
                  <span class="fa fa-star"></span>
                </div>
                <div class="review">
                  <a href="#/">( 5 Customer Review )</a>
                </div>
              </div>
              <div class="single-product-featured">
                <ul>
                  <li><i class="fa fa-check"></i> Free Shipping</li>
                  <li><i class="fa fa-check"></i> Support 24/7</li>
                  <li><i class="fa fa-check"></i> Money Return</li>
                </ul>
              </div>
              <p class="product-desc">Lorem ipsum dolor sit amet, consect adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quisll exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duisol aute irure dolor in reprehenderit.</p>
              <div class="quick-product-action">
                <div class="action-top">
                  <div class="pro-qty">
                    <input type="text" id="quantity" title="Quantity" value="01" />
                  </div>
                  <button class="btn btn-theme">Add to Cart</button>
                  <a class="btn-wishlist" href="shop-wishlist.html">Add to Wishlist</a>
                </div>
              </div>
              <div class="widget">
                <h3 class="title">SKU:</h3>
                <div class="widget-tags">
                  <span>Ch-256xl</span>
                </div>
              </div>
              <div class="widget">
                <h3 class="title">Categories:</h3>
                <div class="widget-tags">
                  <a href="blog.html">Toys.</a>
                  <a href="blog.html">Dresss</a>
                </div>
              </div>
              <div class="widget">
                <h3 class="title">Tag:</h3>
                <div class="widget-tags">
                  <a href="blog.html">Toys,</a>
                  <a href="blog.html">Dress</a>
                </div>
              </div>
              <div class="widget">
                <h3 class="title">Share:</h3>
                <div class="widget-tags widget-share">
                  <span class="fa fa-facebook"></span>
                  <span class="fa fa-dribbble"></span>
                  <span class="fa fa-pinterest-p"></span>
                  <span class="fa fa-twitter"></span>
                  <span class="fa fa-linkedin"></span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="canvas-overlay"></div>
  </aside>
  <!--== End Product Quick View ==-->

  <!--== Start Aside Search Menu ==-->
  <div class="search-box-wrapper">
    <div class="search-box-content-inner">
      <div class="search-box-form-wrap">
        <div class="search-note">
          <p>Start typing and press Enter to search</p>
        </div>
        <form action="#" method="post">
          <div class="search-form position-relative">
            <label for="search-input" class="sr-only">Search</label>
            <input type="search" class="form-control" placeholder="Search" id="search-input">
            <button class="search-button"><i class="pe-7s-search"></i></button>
          </div>
        </form>
      </div>
    </div>
    <!--== End Aside Search Menu ==-->
    <a href="javascript:;" class="search-close"><i class="pe-7s-close"></i></a>
  </div>
  <!--== End Aside Search Menu ==-->

  <!--== Start Sidebar Cart Menu ==-->
  <aside class="sidebar-cart-modal">
    <div class="sidebar-cart-inner">
      <div class="sidebar-cart-content">
        <a class="cart-close" href="javascript:void(0);"><i class="pe-7s-close"></i></a>
        <div class="sidebar-cart-all">
          <div class="cart-header">
            <h3>Shopping Cart</h3>
            <div class="close-style-wrap">
              <span class="close-style close-style-width-1 cart-close"></span>
            </div>
          </div>
          <div class="cart-content cart-content-padding">
            <ul id="sidebar-cart-items">
              <!-- Cart items will be loaded dynamically here -->
            </ul>
            <div class="cart-total">
              <h4>Subtotal: <span id="sidebar-cart-subtotal">LKR 0.00</span></h4>
            </div>
            <div class="cart-checkout-btn">
              <a class="cart-btn" href="shop-cart.html">view cart</a>
              <a class="checkout-btn" href="shop-checkout.html">checkout</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-cart-overlay"></div>
  <!--== End Sidebar Cart Menu ==-->

  <!--== Start Side Menu ==-->
  <aside class="off-canvas-wrapper">
    <div class="off-canvas-inner">
      <div class="off-canvas-overlay d-none"></div>
      <!-- Start Off Canvas Content Wrapper -->
      <div class="off-canvas-content">
        <!-- Off Canvas Header -->
        <div class="off-canvas-header">
          <div class="close-action">
            <button class="btn-close"><i class="pe-7s-close"></i></button>
          </div>
        </div>

        <div class="off-canvas-item">
          <!-- Start Mobile Menu Wrapper -->
          <div class="res-mobile-menu">
            <!-- Note Content Auto Generate By Jquery From Main Menu -->
          </div>
          <!-- End Mobile Menu Wrapper -->
        </div>
        <!-- Off Canvas Footer -->
        <div class="off-canvas-footer"></div>
      </div>
      <!-- End Off Canvas Content Wrapper -->
    </div>
  </aside>
  <!--== End Side Menu ==-->
</div>

<!--=======================Javascript============================-->

<!--=== Modernizr Min Js ===-->
<script src="/assets/js/modernizr.js"></script>
<!--=== jQuery Min Js ===-->
<script src="/assets/js/jquery-main.js"></script>
<!--=== jQuery Migration Min Js ===-->
<script src="/assets/js/jquery-migrate.js"></script>
<!--=== Popper Min Js ===-->
<script src="/assets/js/popper.min.js"></script>
<!--=== Bootstrap Min Js ===-->
<script src="/assets/js/bootstrap.min.js"></script>
<!--=== jquery Appear Js ===-->
<script src="/assets/js/jquery.appear.js"></script>
<!--=== jquery Swiper Min Js ===-->
<script src="/assets/js/swiper.min.js"></script>
<!--=== jquery Fancybox Min Js ===-->
<script src="/assets/js/fancybox.min.js"></script>
<!--=== jquery Aos Min Js ===-->
<script src="/assets/js/aos.min.js"></script>
<!--=== jquery Slicknav Js ===-->
<script src="/assets/js/jquery.slicknav.js"></script>
<!--=== jquery Countdown Js ===-->
<script src="/assets/js/jquery.countdown.min.js"></script>
<!--=== jquery Tippy Js ===-->
<script src="/assets/js/tippy.all.min.js"></script>
<!--=== Isotope Min Js ===-->
<script src="/assets/js/isotope.pkgd.min.js"></script>
<!--=== Parallax Min Js ===-->
<script src="/assets/js/parallax.min.js"></script>
<!--=== Slick  Min Js ===-->
<script src="/assets/js/slick.min.js"></script>
<!--=== jquery Wow Min Js ===-->
<script src="/assets/js/wow.min.js"></script>
<!--=== jquery Zoom Min Js ===-->
<script src="/assets/js/jquery-zoom.min.js"></script>

<!--=== API Config Js ===-->
<script src="/assets/js/config.js"></script>
<!--=== API Service Js ===-->
<script src="/assets/js/api-service.js"></script>
<!--=== Cart Service Js ===-->
<script src="/assets/js/cart-service.js"></script>
<!--=== Custom Js ===-->
<script src="/assets/js/custom.js"></script>

<!-- Checkout Page Integration -->
<style>
  /* Toast Notification Styles */
  .toast-notification {
    position: fixed;
    top: 20px;
    right: 20px;
    background-color: #4CAF50;
    color: white;
    padding: 16px 24px;
    border-radius: 4px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    z-index: 99999;
    display: flex;
    align-items: center;
    gap: 12px;
    min-width: 300px;
    max-width: 500px;
    animation: slideInRight 0.3s ease-out;
    font-size: 14px;
  }
  
  .toast-notification.success {
    background-color: #4CAF50;
  }
  
  .toast-notification.error {
    background-color: #f44336;
  }
  
  .toast-notification.warning {
    background-color: #ff9800;
  }
  
  .toast-notification.info {
    background-color: #2196F3;
  }
  
  .toast-notification .toast-icon {
    font-size: 20px;
  }
  
  .toast-notification .toast-message {
    flex: 1;
  }
  
  .toast-notification .toast-close {
    cursor: pointer;
    font-size: 18px;
    opacity: 0.8;
    transition: opacity 0.2s;
    line-height: 1;
  }
  
  .toast-notification .toast-close:hover {
    opacity: 1;
  }
  
  @keyframes slideInRight {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slideOutRight {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }
  
  .toast-notification.hide {
    animation: slideOutRight 0.3s ease-out forwards;
  }
</style>
<script>
(function($) {
  'use strict';

  // Toast notification function
  function showToast(message, type = 'success') {
    // Remove existing toasts
    $('.toast-notification').remove();
    
    let icon = '<i class="fa fa-check-circle"></i>';
    if (type === 'error') {
      icon = '<i class="fa fa-exclamation-circle"></i>';
    } else if (type === 'warning') {
      icon = '<i class="fa fa-exclamation-triangle"></i>';
    } else if (type === 'info') {
      icon = '<i class="fa fa-info-circle"></i>';
    }
    
    const toast = $(`
      <div class="toast-notification ${type}">
        <span class="toast-icon">${icon}</span>
        <span class="toast-message">${message}</span>
        <span class="toast-close">&times;</span>
      </div>
    `);
    
    $('body').append(toast);
    
    // Auto hide after 5 seconds for errors, 3 seconds for others
    const hideDelay = type === 'error' ? 5000 : 3000;
    setTimeout(function() {
      toast.addClass('hide');
      setTimeout(function() {
        toast.remove();
      }, 300);
    }, hideDelay);
    
    // Close on click
    toast.find('.toast-close').on('click', function() {
      toast.addClass('hide');
      setTimeout(function() {
        toast.remove();
      }, 300);
    });
  }

  // Format price with LKR currency
  function formatPrice(price) {
    if (price === null || price === undefined || price === 0) {
      return 'LKR 0.00';
    }
    return 'LKR ' + parseFloat(price).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
  }

  // Calculate shipping cost based on order total
  function calculateShippingCost(subtotal) {
    // Free shipping if order is over 40,000 LKR, otherwise 450 LKR
    if (subtotal >= 40000) {
      return 0;
    }
    return 450;
  }

  // Load cart items into checkout order summary
  function loadOrderSummary() {
    const cart = CartService.getCart();
    const orderList = $('.your-order-product ul');
    const subtotalEl = $('#checkout-subtotal');
    const shippingEl = $('#checkout-shipping');
    const totalEl = $('#checkout-total');

    if (cart.length === 0) {
      orderList.html('<li>Your cart is empty. <a href="shop-left-sidebar.html">Continue Shopping</a></li>');
      subtotalEl.text('LKR 0.00');
      shippingEl.text('LKR 450.00');
      totalEl.text('LKR 0.00');
      return;
    }

    orderList.empty();
    let subtotal = 0;

    cart.forEach((item) => {
      const itemTotal = item.price * item.quantity;
      subtotal += itemTotal;

      const itemHtml = `
        <li>${item.name} <span>x ${item.quantity}</span> <span class="float-end">${formatPrice(itemTotal)}</span></li>
      `;
      orderList.append(itemHtml);
    });

    // Calculate shipping cost
    const shippingCost = calculateShippingCost(subtotal);
    const total = subtotal + shippingCost;

    subtotalEl.text(formatPrice(subtotal));
    shippingEl.text(formatPrice(shippingCost));
    totalEl.text(formatPrice(total));
  }

  // Prefill billing details from logged-in user
  function prefillBillingDetails() {
    const currentUser = window.getCurrentUser ? window.getCurrentUser() : null;

    if (currentUser) {
      // Prefill form fields with user data
      $('.billing-info-wrap input[type="text"]').eq(0).val(currentUser.firstName || '');
      $('.billing-info-wrap input[type="text"]').eq(1).val(currentUser.lastName || '');

      // Find and fill phone and email fields
      const phoneInput = $('.billing-info-wrap input[type="text"]').filter(function() {
        return $(this).prev('label').text().toLowerCase().includes('phone');
      });
      const emailInput = $('.billing-info-wrap input[type="text"]').filter(function() {
        return $(this).prev('label').text().toLowerCase().includes('email');
      });

      if (phoneInput.length) phoneInput.val(currentUser.mobileNo || '');
      if (emailInput.length) emailInput.val(currentUser.email || '');

      // Fill address if available
      if (currentUser.customerAddresses && currentUser.customerAddresses.length > 0) {
        const address = currentUser.customerAddresses[0];
        $('.billing-address').val(address.addressLine1 || '');
        $('.billing-address').next('input').val(address.addressLine2 || '');
      }
    }
  }

  $(document).ready(function() {
    // Check if user is logged in - mandatory for checkout
    // Check sessionStorage for active session (token expires when browser closes)
    const isLoggedIn = window.isUserLoggedIn ? window.isUserLoggedIn() : false;
    const currentUser = window.getCurrentUser ? window.getCurrentUser() : null;
    const authToken = window.getAuthToken ? window.getAuthToken() : null;
    
    // Only redirect if token is missing - don't show message if token exists
    if (!authToken) {
      // Token is missing, show message and redirect to login page
      showToast('Please login to proceed with checkout.', 'warning');
      setTimeout(() => {
        window.location.href = 'login-register.html?redirect=shop-checkout.html';
      }, 2000);
      return;
    }
    
    // If token exists but user data is missing, still allow (token is the key requirement)
    if (!currentUser && authToken) {
      // Token exists but user data missing - might be a data sync issue, but allow checkout
      // User can still proceed as token is present
    }

    // Update cart count on page load
    if (typeof CartService !== 'undefined') {
      CartService.updateCartCount();
    }

    // Load order summary from cart
    loadOrderSummary();

    // Prefill billing details if user is logged in
    prefillBillingDetails();

    // Create order function
    async function createOrder(orderData) {
      try {
        // Get authentication headers with token - mandatory for checkout
        const currentUser = window.getCurrentUser ? window.getCurrentUser() : null;
        const authToken = window.getAuthToken ? window.getAuthToken() : null;
        
        if (!authToken) {
          throw new Error('Please login to proceed with checkout.');
        }

        // Get headers with authentication token - use getAuthHeaders to ensure token is included
        let headers = {};
        if (window.getAuthHeaders) {
          headers = window.getAuthHeaders();
        } else {
          headers = {
            'Content-Type': 'application/json',
            'Accept': 'application/json'
          };
        }

        // Explicitly ensure Authorization header is set with token
        if (authToken) {
          headers['Authorization'] = `Bearer ${authToken}`;
        } else {
          throw new Error('Authentication token is missing. Please login again.');
        }

        const apiUrl = API_CONFIG.BASE_URL + '/pos/shopping-cart-orders';

        // Ensure headers are properly formatted for fetch API
        const fetchHeaders = {
          'Content-Type': 'application/json',
          'Accept': 'application/json'
        };
        
        // Add Authorization header with token
        if (authToken) {
          fetchHeaders['Authorization'] = `Bearer ${authToken}`;
        }

        const response = await fetch(apiUrl, {
          method: 'POST',
          headers: fetchHeaders,
          body: JSON.stringify(orderData)
        });

        if (!response.ok) {
          let errorData = {};
          try {
            const errorText = await response.text();
            if (errorText) {
              errorData = JSON.parse(errorText);
            }
          } catch (e) {
            // Error parsing error response - use default error message
          }
          
          // Handle 401 Unauthorized specifically
          if (response.status === 401) {
            throw new Error('Authentication failed. Please check your login and try again.');
          }
          
          const errorMessage = errorData.message || errorData.error?.message || `Order creation failed (Status: ${response.status})`;
          throw new Error(errorMessage);
        }

        const data = await response.json();
        
        // Handle both direct response and wrapped response
        const order = data.data || data;
        
        return {
          success: true,
          order: order,
          message: data.message || 'Order created successfully!'
        };
      } catch (error) {
        return {
          success: false,
          message: error.message || 'Order creation failed. Please try again.'
        };
      }
    }

    // Handle place order button
    $('.place-order a').on('click', async function(e) {
      e.preventDefault();

      // Check sessionStorage for active session
      const isLoggedIn = window.isUserLoggedIn ? window.isUserLoggedIn() : false;
      const currentUser = window.getCurrentUser ? window.getCurrentUser() : null;
      const authToken = window.getAuthToken ? window.getAuthToken() : null;
      const cart = CartService.getCart();

      if (cart.length === 0) {
        showToast('Your cart is empty. Please add items before checkout.', 'warning');
        return;
      }

      // Check if token exists - mandatory for checkout
      if (!authToken) {
        showToast('Please login to proceed with checkout.', 'warning');
        setTimeout(() => {
          window.location.href = 'login-register.html?redirect=shop-checkout.html';
        }, 2000);
        return;
      }

      // Get form values
      const billingInfo = {
        firstName: $('.billing-info-wrap input[type="text"]').eq(0).val()?.trim() || '',
        lastName: $('.billing-info-wrap input[type="text"]').eq(1).val()?.trim() || '',
        companyName: null, // Company name field removed
        streetAddress1: $('.billing-info-wrap .billing-address').eq(0).val()?.trim() || '',
        streetAddress2: $('.billing-info-wrap .billing-address').eq(0).next('input').val()?.trim() || '',
        city: $('.billing-info-wrap input[type="text"]').eq(2).val()?.trim() || '',
        district: $('.billing-info-wrap input[type="text"]').eq(3).val()?.trim() || '',
        postalCode: $('.billing-info-wrap input[type="text"]').eq(4).val()?.trim() || '',
        phone: $('.billing-info-wrap input[type="text"]').filter(function() {
          return $(this).prev('label').text().toLowerCase().includes('phone');
        }).val()?.trim() || '',
        email: $('.billing-info-wrap input[type="text"]').filter(function() {
          return $(this).prev('label').text().toLowerCase().includes('email');
        }).val()?.trim() || (currentUser ? currentUser.email : '') || ''
      };

      // Validate required fields
      if (!billingInfo.firstName || !billingInfo.lastName || 
          !billingInfo.streetAddress1 || !billingInfo.city || !billingInfo.district || !billingInfo.phone || !billingInfo.email) {
        showToast('Please fill in all required billing fields.', 'warning');
        return;
      }

      // Shipping address is same as billing (removed different address option)
      let deliveryInfo = null;

      // Get payment method
      const paymentMethod = $('input[name="payment_method"]:checked').val() || 'BankTransfer';
      const paymentMethodText = $('input[name="payment_method"]:checked').next('label').text().trim();
      
      // Map payment method text to code
      let paymentMethodCode = 'BankTransfer';
      if (paymentMethodText.toLowerCase().includes('bank')) {
        paymentMethodCode = 'BankTransfer';
      }

      // Get shipping method
      const shippingMethod = 'Free';
      let shippingMethodCode = 'Free';

      // Get order notes
      const orderNotes = $('textarea[name="message"]').val()?.trim() || '';

      // Calculate totals
      const subtotal = cart.reduce((sum, item) => sum + ((item.price || 0) * (item.quantity || 1)), 0);
      const discountAmount = 0; // You can add coupon logic here
      
      // Calculate shipping cost: 450 LKR if subtotal < 40,000, free if >= 40,000
      let shippingCost = calculateShippingCost(subtotal);
      
      const totalAmount = subtotal - discountAmount + shippingCost;

      // Prepare order data
      const orderData = {
        // Billing address
        billingFirstName: billingInfo.firstName,
        billingLastName: billingInfo.lastName,
        billingCompanyName: null,
        billingCountry: '',
        billingStreetAddress1: billingInfo.streetAddress1,
        billingStreetAddress2: billingInfo.streetAddress2 || null,
        billingCity: billingInfo.city,
        billingDistrict: billingInfo.district,
        billingState: '',
        billingPostalCode: billingInfo.postalCode || null,
        
        // Contact info
        email: billingInfo.email,
        phoneNumber: billingInfo.phone,
        
        // Delivery address (if different)
        deliveryFirstName: deliveryInfo ? deliveryInfo.firstName : null,
        deliveryLastName: deliveryInfo ? deliveryInfo.lastName : null,
        deliveryCompanyName: deliveryInfo ? deliveryInfo.companyName : null,
        deliveryCountry: deliveryInfo ? deliveryInfo.country : null,
        deliveryStreetAddress1: deliveryInfo ? deliveryInfo.streetAddress1 : null,
        deliveryStreetAddress2: deliveryInfo ? deliveryInfo.streetAddress2 : null,
        deliveryCity: deliveryInfo ? deliveryInfo.city : null,
        deliveryState: deliveryInfo ? deliveryInfo.state : null,
        deliveryPostalCode: deliveryInfo ? deliveryInfo.postalCode : null,
        
        // Payment and shipping
        paymentMethod: paymentMethodCode,
        shippingMethod: shippingMethodCode,
        shippingCost: shippingCost,
        
        // Order items
        orderItems: cart.map(item => ({
          productId: item.id,
          productName: item.name || 'Product',
          productImageUrl: item.imageURL || item.imageUrl || null,
          quantity: item.quantity || 1,
          unitPrice: item.price || 0,
          discountAmount: 0
        })),
        
        // Discount and notes
        discountAmount: discountAmount,
        couponCode: null,
        orderNotes: orderNotes || null
      };

      // Disable button and show loading
      const placeOrderBtn = $(this);
      const originalText = placeOrderBtn.text();
      placeOrderBtn.prop('disabled', true).text('Placing Order...');

      try {
        // Create order
        const result = await createOrder(orderData);

        if (result.success && result.order) {
          // Clear cart
          CartService.clearCart();
          CartService.updateCartCount();

          // Show success message
          const orderNumber = result.order.orderNumber || result.order.orderNo || 'N/A';
          const orderId = result.order.id || result.order.orderId || '';
          showToast('Order placed successfully! Order Number: ' + orderNumber, 'success');
          
          // Redirect to order confirmation page or order details
          setTimeout(() => {
            if (orderId) {
              window.location.href = 'my-account.html?order=' + orderId;
            } else {
              window.location.href = 'shop-cart.html';
            }
          }, 2000);
        } else {
          const errorMsg = result.message || 'Failed to place order. Please try again.';
          showToast(errorMsg, 'error');
          placeOrderBtn.prop('disabled', false).text(originalText);
        }
      } catch (error) {
        const errorMsg = error.message || 'An error occurred while placing your order. Please try again.';
        showToast(errorMsg, 'error');
        
        // If authentication error, redirect to login (but don't clear sessionStorage)
        if (errorMsg.includes('session has expired') || errorMsg.includes('login') || errorMsg.includes('Authentication')) {
          // DO NOT call logoutUser() - preserve sessionStorage
          // Just redirect to login page
          setTimeout(() => {
            window.location.href = 'login-register.html?redirect=shop-checkout.html';
          }, 2000);
        } else {
          placeOrderBtn.prop('disabled', false).text(originalText);
        }
      }
    });
  });
})(jQuery);
</script>

</body>

</html>